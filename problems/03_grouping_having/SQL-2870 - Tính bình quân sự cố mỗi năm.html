ID: SQL-2870
Tiêu đề: Tính bình quân sự cố mỗi năm
URL WEB: <a href="https://db.ptit.edu.vn/question-detail/8f851bff-59ea-4e29-a04d-b3db0635b8f9" target="_blank" rel="noopener">https://db.ptit.edu.vn/question-detail/8f851bff-59ea-4e29-a04d-b3db0635b8f9</a>
URL API: <a href="https://dbapi.ptit.edu.vn/api/app/question/8f851bff-59ea-4e29-a04d-b3db0635b8f9" target="_blank" rel="noopener">https://dbapi.ptit.edu.vn/api/app/question/8f851bff-59ea-4e29-a04d-b3db0635b8f9</a>
Loại Database: Mysql
------------------------------

<h3><strong>Bảng union_status: </strong>Chứa thông tin về <strong>trạng thái công đoàn</strong> của người lao động.</h3><ul><li>id (INT): Mã định danh duy nhất cho mỗi trạng thái (khóa chính).</li><li>union_status (VARCHAR(10)): Trạng thái công đoàn (ví dụ: 'Union', 'Non-Union').</li></ul><h3><strong>Bảng construction_sectors: </strong>Chứa thông tin về <strong>các ngành xây dựng</strong>.</h3><ul><li>sector_id (INT): Mã định danh duy nhất cho mỗi ngành (khóa chính).</li><li>sector_name (VARCHAR(255)): Tên ngành (ví dụ: Xây dựng nhà - 'Building Construction' , Xây dựng đường - Highway Construction', Kỹ sư dân dụng - 'Civil Engineering').</li></ul><h3><strong>Bảng workplace_safety_incidents: </strong>Chứa thông tin về <strong>các sự cố an toàn</strong> theo ngành và trạng thái công đoàn.</h3><ul><li>id (INT): Mã định danh duy nhất cho mỗi sự cố (khóa chính).</li><li>sector_id (INT): Tham chiếu tới construction_sectors.sector_id.</li><li>union_status_id (INT): Tham chiếu tới union_status.id.</li><li>incident_year (INT): Năm xảy ra sự cố.</li><li>incidents (INT): Số lượng sự cố trong năm.</li></ul><p><strong>Yêu cầu: </strong>Với mỗi ngành, tính bình quân sự cố mỗi năm trong giai đoạn 2021–2022 cho từng trạng thái công đoàn, sau đó trả về 3 bộ đôi (ngành, trạng thái) có bình quân cao nhất. Kết quả sắp xếp giảm dần theo bình quân cao nhất. </p><p><br></p><p><strong>Output ví dụ: </strong></p><pre class="ql-syntax" spellcheck="false">+-------------+--------------+-------------------------+
| sector_name | union_status | avg_incidents_2021_2022 |
+-------------+--------------+-------------------------+
| Civil&nbsp; &nbsp; &nbsp; &nbsp;| Non-Union&nbsp; &nbsp; | 85&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |
| Building&nbsp; &nbsp; | Union&nbsp; &nbsp; &nbsp; &nbsp; | 65&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |
| Rail&nbsp; &nbsp; &nbsp; &nbsp; | Union&nbsp; &nbsp; &nbsp; &nbsp; | 52.5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |
+-------------+--------------+-------------------------+
</pre>