ID: DEMO-029
Tiêu đề: Khách hàng có tổng chi tiêu lớn và có đơn giá trị cao trong năm 2024
URL WEB: <a href="https://db.ptit.edu.vn/question-detail/2dd4321d-b175-4f95-9f4b-e620fb2aa5b8" target="_blank" rel="noopener">https://db.ptit.edu.vn/question-detail/2dd4321d-b175-4f95-9f4b-e620fb2aa5b8</a>
URL API: <a href="https://dbapi.ptit.edu.vn/api/app/question/2dd4321d-b175-4f95-9f4b-e620fb2aa5b8" target="_blank" rel="noopener">https://dbapi.ptit.edu.vn/api/app/question/2dd4321d-b175-4f95-9f4b-e620fb2aa5b8</a>
Loại Database: Mysql
------------------------------

<p>Hệ thống bán hàng có 2 bảng sau:</p><p><strong>Bảng: Customer</strong></p><pre class="ql-syntax" spellcheck="false">+--------------+--------------+
| Column Name&nbsp; | Type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|
+--------------+--------------+
| CustID&nbsp; &nbsp; &nbsp; &nbsp;| INT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |
| CustomerName | VARCHAR(100) |
| City&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| VARCHAR(50)&nbsp; |
+--------------+--------------+
</pre><p>CustID là mã khách hàng, khóa chính, định danh duy nhất cho mỗi khách.</p><p>CustomerName là tên đầy đủ của khách hàng.</p><p>City là thành phố nơi khách hàng sinh sống.</p><p>Mỗi hàng trong bảng này thể hiện thông tin cơ bản của một khách hàng.</p><p><br></p><p><strong>Bảng: SaleOrder</strong></p><pre class="ql-syntax" spellcheck="false">+--------------+----------------+
| Column Name&nbsp; | Type&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|
+--------------+----------------+
| OrderID&nbsp; &nbsp; &nbsp; | INT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |
| CustID&nbsp; &nbsp; &nbsp; &nbsp;| INT&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |
| OrderDate&nbsp; &nbsp; | DATE&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;|
| TotalAmount&nbsp; | DECIMAL(10,2)&nbsp; |
+--------------+----------------+
</pre><p>OrderID là mã đơn hàng, khóa chính.</p><p>CustID là mã khách hàng đã đặt đơn, khóa ngoại tham chiếu đến CustID trong bảng Customer.</p><p>OrderDate là ngày tạo đơn.</p><p>TotalAmount là tổng tiền của đơn hàng.</p><p>Mỗi hàng trong bảng này thể hiện một đơn hàng của một khách hàng cụ thể.</p><p><br></p><p><strong>Yêu cầu:</strong></p><p>Liệt kê các khách hàng (CustID, CustomerName, TotalSpent) thỏa mãn đồng thời hai điều kiện:</p><p>1. Tổng tiền tất cả các đơn hàng của khách đó lớn hơn hoặc bằng 1000.</p><p>2. Tồn tại ít nhất một đơn hàng của khách đó trong năm 2024 có giá trị TotalAmount ≥ 500.</p><p><br></p><p><strong>Ví dụ:</strong></p><p>Bảng Customer</p><pre class="ql-syntax" spellcheck="false">+--------+---------------+-----------+
| CustID | CustomerName&nbsp; | City&nbsp; &nbsp; &nbsp; |
+--------+---------------+-----------+
| 1&nbsp; &nbsp; &nbsp; | Nguyen Van A&nbsp; | Ha Noi&nbsp; &nbsp; |
| 2&nbsp; &nbsp; &nbsp; | Tran Thi B&nbsp; &nbsp; | Da Nang&nbsp; &nbsp;|
| 3&nbsp; &nbsp; &nbsp; | Le Van C&nbsp; &nbsp; &nbsp; | HCMC&nbsp; &nbsp; &nbsp; |
| 4&nbsp; &nbsp; &nbsp; | Pham Thi D&nbsp; &nbsp; | Hai Phong |
+--------+---------------+-----------+
</pre><p>Bảng SaleOrder</p><pre class="ql-syntax" spellcheck="false">+---------+--------+------------+-------------+
| OrderID | CustID | OrderDate&nbsp; | TotalAmount |
+---------+--------+------------+-------------+
| 101&nbsp; &nbsp; &nbsp;| 1&nbsp; &nbsp; &nbsp; | 2023-12-20 | 400.00&nbsp; &nbsp; &nbsp; |
| 102&nbsp; &nbsp; &nbsp;| 1&nbsp; &nbsp; &nbsp; | 2024-02-10 | 650.00&nbsp; &nbsp; &nbsp; |
| 103&nbsp; &nbsp; &nbsp;| 2&nbsp; &nbsp; &nbsp; | 2024-01-05 | 480.00&nbsp; &nbsp; &nbsp; |
| 104&nbsp; &nbsp; &nbsp;| 2&nbsp; &nbsp; &nbsp; | 2024-03-01 | 520.00&nbsp; &nbsp; &nbsp; |
| 105&nbsp; &nbsp; &nbsp;| 3&nbsp; &nbsp; &nbsp; | 2024-05-20 | 450.00&nbsp; &nbsp; &nbsp; |
| 106&nbsp; &nbsp; &nbsp;| 3&nbsp; &nbsp; &nbsp; | 2023-11-11 | 300.00&nbsp; &nbsp; &nbsp; |
| 107&nbsp; &nbsp; &nbsp;| 4&nbsp; &nbsp; &nbsp; | 2024-07-15 | 900.00&nbsp; &nbsp; &nbsp; |
+---------+--------+------------+-------------+
</pre><p>Kết quả mong muốn:</p><pre class="ql-syntax" spellcheck="false">+--------+---------------+------------+
| CustID | CustomerName&nbsp; | TotalSpent |
+--------+---------------+------------+
| 1&nbsp; &nbsp; &nbsp; | Nguyen Van A&nbsp; | 1050.00&nbsp; &nbsp; |
| 2&nbsp; &nbsp; &nbsp; | Tran Thi B&nbsp; &nbsp; | 1000.00&nbsp; &nbsp; |
+--------+---------------+------------+
</pre>