ID: SQL133
Tiêu đề: Average Selling Price
URL WEB: <a href="https://db.ptit.edu.vn/question-detail/0302d83c-97ef-494c-aebe-ef1d871f67bf" target="_blank" rel="noopener">https://db.ptit.edu.vn/question-detail/0302d83c-97ef-494c-aebe-ef1d871f67bf</a>
URL API: <a href="https://dbapi.ptit.edu.vn/api/app/question/0302d83c-97ef-494c-aebe-ef1d871f67bf" target="_blank" rel="noopener">https://dbapi.ptit.edu.vn/api/app/question/0302d83c-97ef-494c-aebe-ef1d871f67bf</a>
Loại Database: Mysql
------------------------------

<p><strong>Bảng: Prices</strong></p><p>+------------+------------+------------+--------+</p><p>| <strong>Tên Cột</strong> | <strong>Kiểu Dữ Liệu</strong> |</p><p>+------------+------------+------------+--------+</p><p>| product_id | int |</p><p>| start_date | date |</p><p>| end_date | date |</p><p>| price | int |</p><p>+------------+------------+------------+--------+</p><ul><li>(product_id, start_date, end_date) là khóa chính (tổ hợp các cột có giá trị duy nhất).</li><li>Mỗi hàng biểu thị giá của sản phẩm (product_id) trong khoảng thời gian từ start_date đến end_date.</li><li>Với mỗi product_id, không có hai khoảng thời gian nào trùng lặp.</li></ul><p><strong>Bảng: UnitsSold</strong></p><p>+------------+---------------+-------+</p><p>| <strong>Tên Cột</strong> | <strong>Kiểu Dữ Liệu</strong> |</p><p>+------------+---------------+-------+</p><p>| product_id | int |</p><p>| purchase_date | date |</p><p>| units | int |</p><p>+------------+---------------+-------+</p><ul><li>Bảng này có thể chứa các hàng trùng lặp.</li><li>Mỗi hàng biểu thị ngày bán (purchase_date), số lượng (units), và sản phẩm (product_id) được bán.</li></ul><p><br></p><p><strong>Yêu cầu:</strong></p><p>Viết một giải pháp để tìm giá bán trung bình (<strong>average_price</strong>) của mỗi sản phẩm.</p><ul><li>average_price = <strong>Tổng giá bán</strong> / <strong>Tổng số lượng sản phẩm bán được</strong>.</li><li>Làm tròn giá bán trung bình đến 2 chữ số thập phân.</li><li>Nếu sản phẩm không có bất kỳ đơn vị nào được bán, giá bán trung bình được giả định là 0.</li></ul><p>Trả về bảng kết quả với thứ tự bất kỳ.</p><p><br></p><p><strong>Ví dụ 1:</strong></p><p><strong>Đầu vào:</strong></p><p><strong>Bảng Prices:</strong></p><p>+------------+------------+------------+--------+</p><p>| product_id | start_date | end_date | price |</p><p>+------------+------------+------------+--------+</p><p>| 1 | 2019-02-17 | 2019-02-28 | 5 |</p><p>| 1 | 2019-03-01 | 2019-03-22 | 20 |</p><p>| 2 | 2019-02-01 | 2019-02-20 | 15 |</p><p>| 2 | 2019-02-21 | 2019-03-31 | 30 |</p><p>+------------+------------+------------+--------+</p><p><strong>Bảng UnitsSold:</strong></p><p>+------------+---------------+-------+</p><p>| product_id | purchase_date | units |</p><p>+------------+---------------+-------+</p><p>| 1 | 2019-02-25 | 100 |</p><p>| 1 | 2019-03-01 | 15 |</p><p>| 2 | 2019-02-10 | 200 |</p><p>| 2 | 2019-03-22 | 30 |</p><p>+------------+---------------+-------+</p><p><strong>Đầu ra:</strong></p><p>+------------+---------------+</p><p>| product_id | average_price |</p><p>+------------+---------------+</p><p>| 1 | 6.96 |</p><p>| 2 | 16.96 |</p><p>+------------+---------------+</p><p><br></p><p><strong>Giải thích:</strong></p><ol><li><strong>Sản phẩm 1:</strong></li></ol><ul><li class="ql-indent-1">Ngày 2019-02-25: Giá 5, Số lượng 100.</li><li class="ql-indent-1">Ngày 2019-03-01: Giá 20, Số lượng 15.</li><li class="ql-indent-1">Tổng giá bán = (100 × 5) + (15 × 20) = 500 + 300 = 800.</li><li class="ql-indent-1">Tổng số lượng bán được = 100 + 15 = 115.</li><li class="ql-indent-1">Giá trung bình = 800 / 115 ≈ <strong>6.96</strong>.</li></ul><ol><li><strong>Sản phẩm 2:</strong></li></ol><ul><li class="ql-indent-1">Ngày 2019-02-10: Giá 15, Số lượng 200.</li><li class="ql-indent-1">Ngày 2019-03-22: Giá 30, Số lượng 30.</li><li class="ql-indent-1">Tổng giá bán = (200 × 15) + (30 × 30) = 3000 + 900 = 3900.</li><li class="ql-indent-1">Tổng số lượng bán được = 200 + 30 = 230.</li><li class="ql-indent-1">Giá trung bình = 3900 / 230 ≈ <strong>16.96</strong>.</li></ul><p><br></p>