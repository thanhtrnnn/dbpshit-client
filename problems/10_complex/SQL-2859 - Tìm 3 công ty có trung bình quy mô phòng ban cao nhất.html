ID: SQL-2859
Tiêu đề: Tìm 3 công ty có trung bình quy mô phòng ban cao nhất
URL WEB: <a href="https://db.ptit.edu.vn/question-detail/bd162451-6b4c-4c68-8704-f5300572117e" target="_blank" rel="noopener">https://db.ptit.edu.vn/question-detail/bd162451-6b4c-4c68-8704-f5300572117e</a>
URL API: <a href="https://dbapi.ptit.edu.vn/api/app/question/bd162451-6b4c-4c68-8704-f5300572117e" target="_blank" rel="noopener">https://dbapi.ptit.edu.vn/api/app/question/bd162451-6b4c-4c68-8704-f5300572117e</a>
Loại Database: Mysql
------------------------------

<h3>Cho CSDL bao gồm các bảng như dưới.</h3><h3><strong>Bảng companies: </strong>Chứa thông tin về các công ty.</h3><p><strong>Cấu trúc:</strong></p><ul><li>company_id (INT): Mã định danh duy nhất cho mỗi công ty (khóa chính của bảng).</li><li>company_name (VARCHAR(255)): Tên của công ty.</li></ul><h3><strong>Bảng departments: </strong>Chứa thông tin về các phòng ban trong công ty.</h3><p><strong>Cấu trúc:</strong></p><ul><li>dept_id (INT): Mã định danh duy nhất cho mỗi phòng ban (khóa chính của bảng).</li><li>dept_name (VARCHAR(255)): Tên của phòng ban.</li><li>company_id (INT): Mã định danh của công ty mà phòng ban thuộc về (liên kết với company_id trong bảng companies).</li></ul><h3><strong>Bảng employees: </strong>Chứa thông tin về các nhân viên trong các phòng ban.</h3><p><strong>Cấu trúc:</strong></p><ul><li>employee_id (INT): Mã định danh duy nhất cho mỗi nhân viên (khóa chính của bảng).</li><li>employee_name (VARCHAR(255)): Tên của nhân viên.</li><li>dept_id (INT): Mã định danh của phòng ban nơi nhân viên làm việc (liên kết với dept_id trong bảng departments).</li><li>gender (VARCHAR(10)): Giới tính của nhân viên (ví dụ: 'Male', 'Female').</li></ul><p><strong>Yêu cầu:</strong>Tìm 3 công ty có trung bình quy mô phòng ban cao nhất khi chỉ tính các phòng ban có từ 2 nhân viên trở lên. Chỉ xét những công ty có ít nhất 2 phòng ban đạt điều kiện. Nếu giống nhau, ưu tiên công ty có tỷ lệ nhân viên nữ cao hơn (tỷ lệ được tính trên đúng các phòng ban được tính). Sắp xếp theo thứ tự tỷ lên nhân viên nữ giảm dần.</p><p><strong>Output ví dụ: </strong></p><pre class="ql-syntax" spellcheck="false">+--------------+---------------+-------------------+
| company_name | avg_dept_size | female_percentage |
+--------------+---------------+-------------------+
| EastPoint&nbsp; &nbsp; | 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 75&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |
| NorthStar&nbsp; &nbsp; | 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 50&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |
| SouthLight&nbsp; &nbsp;| 2.5&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;| 40&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; |
+--------------+---------------+-------------------+
</pre>