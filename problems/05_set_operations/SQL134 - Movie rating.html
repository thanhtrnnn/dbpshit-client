ID: SQL134
Tiêu đề: Movie rating
URL WEB: https://db.ptit.edu.vn/question-detail/16233627-ab8d-4757-9c9a-bec118308510
URL API: https://dbapi.ptit.edu.vn/api/app/question/16233627-ab8d-4757-9c9a-bec118308510
Loại Database: Mysql
------------------------------

<p><strong>Bảng: Movies</strong></p><p>+-------------+---------+</p><p>| <strong>Tên Cột</strong> | <strong>Kiểu Dữ Liệu</strong> |</p><p>+-------------+---------+</p><p>| movie_id | int |</p><p>| title | varchar |</p><p>+-------------+---------+</p><p><br></p><ul><li>movie_id là khóa chính (cột có giá trị duy nhất).</li><li>title chứa tên của bộ phim.</li></ul><p><strong>Bảng: Users</strong></p><p>+-------------+---------+</p><p>| <strong>Tên Cột</strong> | <strong>Kiểu Dữ Liệu</strong> |</p><p>+-------------+---------+</p><p>| user_id | int |</p><p>| name | varchar |</p><p>+-------------+---------+</p><ul><li>user_id là khóa chính (cột có giá trị duy nhất).</li><li>name chứa tên của người dùng, và giá trị trong cột này là duy nhất.</li></ul><p><strong>Bảng: MovieRating</strong></p><p>+-------------+---------+</p><p>| <strong>Tên Cột</strong> | <strong>Kiểu Dữ Liệu</strong> |</p><p>+-------------+---------+</p><p>| movie_id | int |</p><p>| user_id | int |</p><p>| rating | int |</p><p>| created_at | date |</p><p>+-------------+---------+</p><ul><li>(movie_id, user_id) là khóa chính (cột có giá trị duy nhất).</li><li>Bảng này chứa đánh giá của người dùng (rating) về các bộ phim (movie_id).</li><li>created_at ghi lại ngày mà người dùng thực hiện đánh giá.</li></ul><p><br></p><p><strong>Yêu cầu:</strong></p><ol><li>Tìm tên của người dùng đã đánh giá nhiều bộ phim nhất. Trong trường hợp có nhiều người dùng đánh giá số lượng phim như nhau, trả về tên người có thứ tự từ điển (lexicographically) nhỏ hơn.</li><li>Tìm tên của bộ phim có xếp hạng trung bình cao nhất trong tháng 2 năm 2020. Trong trường hợp có nhiều phim có xếp hạng trung bình bằng nhau, trả về tên phim có thứ tự từ điển (lexicographically) nhỏ hơn.</li></ol><p>Trả về bảng kết quả với một cột results.</p><p><br></p><p><strong>Ví dụ 1:</strong></p><p><strong>Đầu vào:</strong></p><p><strong>Bảng Movies:</strong></p><p>+-------------+--------------+</p><p>| movie_id | title |</p><p>+-------------+--------------+</p><p>| 1 | Avengers |</p><p>| 2 | Frozen 2 |</p><p>| 3 | Joker |</p><p>+-------------+--------------+</p><p><strong>Bảng Users:</strong></p><p>+-------------+--------------+</p><p>| user_id | name |</p><p>+-------------+--------------+</p><p>| 1 | Daniel |</p><p>| 2 | Monica |</p><p>| 3 | Maria |</p><p>| 4 | James |</p><p>+-------------+--------------+</p><p><strong>Bảng MovieRating:</strong></p><p>+-------------+--------------+--------------+-------------+</p><p>| movie_id | user_id | rating | created_at|</p><p>+-------------+--------------+--------------+-------------+</p><p>| 1 | 1 | 3 | 2020-01-12 |</p><p>| 1 | 2 | 4 | 2020-02-11 |</p><p>| 1 | 3 | 2 | 2020-02-12 |</p><p>| 1 | 4 | 1 | 2020-01-01 |</p><p>| 2 | 1 | 5 | 2020-02-17 |</p><p>| 2 | 2 | 2 | 2020-02-01 |</p><p>| 2 | 3 | 2 | 2020-03-01 |</p><p>| 3 | 1 | 3 | 2020-02-22 |</p><p>| 3 | 2 | 4 | 2020-02-25 |</p><p>+-------------+--------------+--------------+-------------+</p><p><strong>Đầu ra:</strong></p><p>+--------------+</p><p>| results |</p><p>+--------------+</p><p>| Daniel |</p><p>| Frozen 2 |</p><p>+--------------+</p><p><strong>Giải thích:</strong></p><ol><li><strong>Người dùng đánh giá nhiều phim nhất:</strong></li></ol><ul><li class="ql-indent-1">Daniel và Monica đều đánh giá 3 bộ phim: "Avengers", "Frozen 2", và "Joker".</li><li class="ql-indent-1">Tên của Daniel nhỏ hơn lexicographically, nên kết quả là <strong>Daniel</strong>.</li></ul><ol><li><strong>Bộ phim có xếp hạng trung bình cao nhất trong tháng 2 năm 2020:</strong></li></ol><ul><li class="ql-indent-1">Frozen 2: (5 + 2) / 2 = 3.5.</li><li class="ql-indent-1">Joker: (3 + 4) / 2 = 3.5.</li><li class="ql-indent-1">Cả hai phim có cùng xếp hạng trung bình, nhưng <strong>Frozen 2</strong> có thứ tự từ điển nhỏ hơn, nên kết quả là <strong>Frozen 2</strong>.</li></ul>