ID: SQL97
Tiêu đề: Average time of process per machine
URL WEB: https://db.ptit.edu.vn/question-detail/df5664b3-a36a-4078-92f2-e42a9edc4861
URL API: https://dbapi.ptit.edu.vn/api/app/question/df5664b3-a36a-4078-92f2-e42a9edc4861
Loại Database: Sql Server
------------------------------

<p><strong>Bảng: Activity</strong></p><p><img src="https://dbapi.ptit.edu.vn/api/app/media/files/2024-12-23/1734926833183_image.png"></p><ul><li>(machine_id, process_id, activity_type) là khóa chính (tổ hợp các cột có giá trị duy nhất) của bảng này.</li><li>machine_id là ID của máy.</li><li>process_id là ID của một tiến trình chạy trên máy có machine_id.</li><li>activity_type là kiểu ENUM với các giá trị ('start', 'end'):</li><li class="ql-indent-1">'start' nghĩa là máy bắt đầu tiến trình tại thời điểm timestamp.</li><li class="ql-indent-1">'end' nghĩa là máy kết thúc tiến trình tại thời điểm timestamp.</li><li>timestamp là giá trị thời gian (float) đại diện cho thời gian hiện tại tính bằng giây.</li></ul><p><br></p><p><strong>Yêu cầu:</strong></p><p>Có một trang web của nhà máy có nhiều máy, mỗi máy chạy cùng số lượng tiến trình. Viết một giải pháp để tìm thời gian trung bình mà mỗi máy thực hiện một tiến trình.</p><ul><li>Thời gian hoàn thành một tiến trình được tính bằng:</li><li>timestamp của 'end' - timestamp của 'start'.</li><li>Thời gian trung bình được tính bằng tổng thời gian hoàn thành của tất cả các tiến trình trên máy chia cho số lượng tiến trình được chạy.</li></ul><p>Bảng kết quả nên chứa machine_id cùng với thời gian trung bình (processing_time), làm tròn đến 3 chữ số thập phân.</p><p><br></p><h3>Ví dụ:</h3><p><strong>Đầu vào:</strong></p><p><strong>Bảng Activity:</strong></p><p><img src="https://dbapi.ptit.edu.vn/api/app/media/files/2024-12-23/1734926869756_image.png"></p><p><strong>Đầu ra:</strong></p><p><img src="https://dbapi.ptit.edu.vn/api/app/media/files/2024-12-23/1734926892362_image.png"></p><p><br></p><p><strong>Giải thích:</strong></p><p>Có 3 máy, mỗi máy chạy 2 tiến trình.</p><ul><li><strong>Máy 0:</strong></li><li class="ql-indent-1">Tiến trình 0: (1.520 - 0.712) = 0.808.</li><li class="ql-indent-1">Tiến trình 1: (4.120 - 3.140) = 0.980.</li><li class="ql-indent-1">Thời gian trung bình: (0.808 + 0.980) / 2 = 0.894.</li><li><strong>Máy 1:</strong></li><li class="ql-indent-1">Tiến trình 0: (1.550 - 0.550) = 1.000.</li><li class="ql-indent-1">Tiến trình 1: (1.420 - 0.430) = 0.990.</li><li class="ql-indent-1">Thời gian trung bình: (1.000 + 0.990) / 2 = 0.995.</li><li><strong>Máy 2:</strong></li><li class="ql-indent-1">Tiến trình 0: (4.512 - 4.100) = 0.412.</li><li class="ql-indent-1">Tiến trình 1: (5.000 - 2.500) = 2.500.</li><li class="ql-indent-1">Thời gian trung bình: (0.412 + 2.500) / 2 = 1.456.</li></ul><p><br></p>